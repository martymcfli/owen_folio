<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="../favicon.png">
    <link rel="apple-touch-icon" href="../favicon.png">
    <title>Chat with Owen's AI Agent</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg-primary: #0f1419;
            --bg-secondary: #1a1f25;
            --bg-chat: #1c2127;
            --border: #2d3748;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --accent: #14b8a6;
            --accent-hover: #0d9488;
            --user-bubble: #14b8a6;
            --ai-bubble: #2d3748;
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            padding: 16px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .avatar {
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, var(--accent) 0%, #0d9488 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
        }

        .header-info h1 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .header-info p {
            font-size: 12px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: #22c55e;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .header-right a {
            color: var(--accent);
            text-decoration: none;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* Chat Container */
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            max-width: 800px;
            width: 100%;
            margin: 0 auto;
            padding: 24px;
            overflow: hidden;
        }

        .messages {
            flex: 1;
            overflow-y: auto;
            padding-right: 8px;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .message {
            display: flex;
            gap: 12px;
            max-width: 85%;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.user {
            align-self: flex-end;
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            flex-shrink: 0;
        }

        .message.ai .message-avatar {
            background: linear-gradient(135deg, var(--accent) 0%, #0d9488 100%);
        }

        .message.user .message-avatar {
            background: var(--ai-bubble);
        }

        .message-content {
            padding: 12px 16px;
            border-radius: 16px;
            font-size: 14px;
            line-height: 1.6;
        }

        .message.ai .message-content {
            background: var(--ai-bubble);
            border-bottom-left-radius: 4px;
        }

        .message.user .message-content {
            background: var(--user-bubble);
            border-bottom-right-radius: 4px;
        }

        .message-content p {
            margin-bottom: 8px;
        }

        .message-content p:last-child {
            margin-bottom: 0;
        }

        .message-content ul, .message-content ol {
            margin: 8px 0;
            padding-left: 20px;
        }

        .message-content li {
            margin-bottom: 4px;
        }

        .message-content strong {
            color: var(--accent);
        }

        .message-content a {
            color: var(--accent);
            text-decoration: underline;
        }

        /* Typing Indicator */
        .typing-indicator {
            display: none;
            gap: 12px;
            max-width: 85%;
        }

        .typing-indicator.active {
            display: flex;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
            padding: 16px;
            background: var(--ai-bubble);
            border-radius: 16px;
            border-bottom-left-radius: 4px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--text-secondary);
            border-radius: 50%;
            animation: typingBounce 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typingBounce {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--border);
        }

        .quick-action {
            padding: 8px 16px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 20px;
            color: var(--text-primary);
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .quick-action:hover {
            background: var(--accent);
            border-color: var(--accent);
        }

        /* Input Area */
        .input-area {
            padding: 16px 0;
            border-top: 1px solid var(--border);
            margin-top: 16px;
        }

        .input-wrapper {
            display: flex;
            gap: 12px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 8px;
            transition: border-color 0.2s ease;
        }

        .input-wrapper:focus-within {
            border-color: var(--accent);
        }

        .input-wrapper input {
            flex: 1;
            background: transparent;
            border: none;
            outline: none;
            color: var(--text-primary);
            font-size: 14px;
            padding: 8px 12px;
        }

        .input-wrapper input::placeholder {
            color: var(--text-secondary);
        }

        .send-btn {
            width: 40px;
            height: 40px;
            background: var(--accent);
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s ease;
        }

        .send-btn:hover {
            background: var(--accent-hover);
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Booking Form (Hidden by default) */
        .booking-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 24px;
        }

        .booking-overlay.active {
            display: flex;
        }

        .booking-form {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 32px;
            max-width: 480px;
            width: 100%;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .booking-form h2 {
            font-size: 20px;
            margin-bottom: 8px;
        }

        .booking-form p {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 24px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 6px;
            color: var(--text-secondary);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 14px;
            outline: none;
            transition: border-color 0.2s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: var(--accent);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .booking-actions {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .btn {
            flex: 1;
            padding: 14px 24px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background: var(--accent);
            border: none;
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-hover);
        }

        .btn-secondary {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            border-color: var(--text-secondary);
        }

        /* Responsive */
        @media (max-width: 640px) {
            .chat-container { padding: 16px; }
            .message { max-width: 95%; }
            .form-row { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-left">
            <div class="avatar">OM</div>
            <div class="header-info">
                <h1>Owen's AI Agent</h1>
                <p><span class="status-dot"></span> Online &middot; Typically replies instantly</p>
            </div>
        </div>
        <div class="header-right">
            <a href="https://omccormick.com" target="_blank">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg>
                View Portfolio
            </a>
        </div>
    </header>

    <div class="chat-container">
        <div class="messages" id="messages">
            <!-- Messages will be inserted here -->
        </div>

        <div class="typing-indicator" id="typingIndicator">
            <div class="message-avatar" style="background: linear-gradient(135deg, var(--accent) 0%, #0d9488 100%);">ðŸ¤–</div>
            <div class="typing-dots">
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            </div>
        </div>

        <div class="quick-actions" id="quickActions">
            <button class="quick-action" onclick="sendQuickMessage('What are Owen\'s main skills?')">Main skills</button>
            <button class="quick-action" onclick="sendQuickMessage('Tell me about his AI projects')">AI projects</button>
            <button class="quick-action" onclick="sendQuickMessage('What\'s his experience with RevOps?')">RevOps experience</button>
            <button class="quick-action" onclick="sendQuickMessage('Is he available for full-time roles?')">Availability</button>
            <button class="quick-action" onclick="sendQuickMessage('What salary range is he looking for?')">Compensation</button>
            <button class="quick-action" onclick="openBooking()">Schedule a call</button>
        </div>

        <div class="input-area">
            <div class="input-wrapper">
                <input type="text" id="userInput" placeholder="Ask me anything about Owen..." onkeypress="handleKeyPress(event)">
                <button class="send-btn" id="sendBtn" onclick="sendMessage()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Booking Form Overlay -->
    <div class="booking-overlay" id="bookingOverlay">
        <div class="booking-form">
            <h2>ðŸ“… Schedule a Call with Owen</h2>
            <p>Fill out the form below and Owen will reach out to confirm a time that works for both of you.</p>

            <form id="bookingForm" onsubmit="submitBooking(event)">
                <div class="form-row">
                    <div class="form-group">
                        <label>Your Name *</label>
                        <input type="text" name="name" required placeholder="Jane Smith">
                    </div>
                    <div class="form-group">
                        <label>Company</label>
                        <input type="text" name="company" placeholder="Acme Inc.">
                    </div>
                </div>

                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required placeholder="jane@company.com">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Role You're Hiring For</label>
                        <input type="text" name="role" placeholder="Operations Manager">
                    </div>
                    <div class="form-group">
                        <label>Preferred Time</label>
                        <select name="timePreference">
                            <option value="morning">Morning (9am-12pm ET)</option>
                            <option value="afternoon">Afternoon (12pm-5pm ET)</option>
                            <option value="evening">Evening (5pm-8pm ET)</option>
                            <option value="flexible">Flexible</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Anything you'd like Owen to know?</label>
                    <textarea name="notes" placeholder="Tell me about the role, your team, or any questions you have..."></textarea>
                </div>

                <div class="booking-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeBooking()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Request Call</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // =====================================================
        // GEMINI API CONFIGURATION
        // =====================================================
        const GEMINI_API_KEY = 'AIzaSyD0KFWW5X5q301-GPfhPBAgq3aSU6qfdg8'; // Replace with your actual key
        const GEMINI_MODEL = 'gemini-2.5-flash';
        const GEMINI_URL = `https://generativelanguage.googleapis.com/v1beta/models/${GEMINI_MODEL}:generateContent?key=${GEMINI_API_KEY}`;

        // System prompt with everything about Owen
        const SYSTEM_PROMPT = `You are Owen McCormick's AI hiring agent. You live on his portfolio website (omccormick.com) and your job is to represent Owen to potential employers, recruiters, and anyone curious about his background. You should be conversational, confident, and genuinely enthusiastic about Owen â€” but never fake or sycophantic. Think of yourself as a sharp, personable recruiter who deeply knows one candidate.

TONE & PERSONALITY:
- Casual but professional. Like a smart friend recommending someone they truly respect.
- Use markdown bold (**text**) for emphasis. Use bullet points (â€¢) for lists.
- Keep responses concise but thorough â€” aim for 3-6 short paragraphs max.
- Sprinkle in personality. Owen built you (an AI agent) to sell himself 24/7 â€” that's the energy.
- When someone asks to schedule a call or meet, enthusiastically encourage it. Mention they can use the booking form or reach out directly.
- If someone asks something you genuinely don't know, say so honestly and suggest they ask Owen directly.
- Never make up information. Only share what's provided below.

OWEN'S FULL PROFILE:

**Identity:**
- Owen McCormick, Strategic Operations Consultant
- Based in Brooklyn, NY (with ties to San Antonio, TX)
- Portfolio: omccormick.com
- Email: mcmcowen@gmail.com
- Phone: 347-268-1742
- LinkedIn: linkedin.com/in/owenpmccormick
- GitHub: github.com/MartyMcfli

**Education & Certifications:**
- B.S. in Business Administration
- Lean Six Sigma Certified (process improvement & waste reduction)
- Scrum Master Certified (agile project management)
- HubSpot RevOps Certified (revenue operations & CRM)

**Core Skills:**
- RevOps & Sales Operations: Pipeline management, CRM optimization (HubSpot, Salesforce), sales-marketing alignment, conversion optimization
- Process Automation: Built systems that reduced manual work by 75%. Uses Zapier, Make, custom scripts, and API integrations.
- AI/ML Integration: Builds AI-powered tools using Gemini API. Not just prompting â€” actual application development.
- Data Analytics & Visualization: Dashboards, reporting, Chart.js, Recharts, data-driven decision making
- Technical: Python, JavaScript, TypeScript, React, SQL, Vite, Node.js, API development
- Strategic: Cross-functional leadership, project management, client relations, problem solving

**Portfolio Projects (all have live demos at omccormick.com):**

1. **Chime Pulse** â€” AI-powered narrative intelligence dashboard for enterprise communications. Real-time sentiment tracking, competitor analysis, AI analyst chat, and strategic insights. Built with React, TypeScript, Gemini API, Recharts. Think "Bloomberg Terminal for brand reputation."

2. **Brandify AI** â€” AI brand identity generator. Enter a mission statement, get a complete brand bible: logos, color palettes, typography, voice guidelines. Uses Gemini API for contextually-aware branding. React, TypeScript, Vite.

3. **SpinnerEvolve** â€” AI evolutionary animation generator. Generates two loading spinner variants, users pick the better one, and it "evolves" the winner. A/B testing meets generative art. React, TypeScript, Gemini API, p5.js.

4. **Opportunity Radar** â€” AI market intelligence scanner. Analyzes emerging trends across industries using Gemini with Google Search Grounding. Surfaces actionable opportunities with predicted roles and impact scores.

5. **AI Chief of Staff** â€” Personal AI executive assistant dashboard. Manages calendar, email triage, task prioritization, job pipeline, energy tracking, and weekly reviews. Full chat interface with 15+ intent patterns.

6. **Culture Heat Map** â€” AI-powered organizational culture diagnostic tool. Survey-based analysis that identifies friction points and engagement patterns across teams. Generates targeted recommendations.

7. **VibeDrive** â€” AI-powered travel companion that generates perfectly-timed playlists synchronized to your drive time. Uses Gemini with Google Maps to calculate routes and curate soundtracks where total runtime matches drive time exactly. A long-time passion project.

8. **Personal Ops Dashboard** â€” 24/7 productivity tracking system running on Raspberry Pi. Tracks personal metrics, habits, and goals with real-time visualizations and AI insights. Python, Chart.js, SQLite.

9. **HubSpot RevOps Pipeline** â€” Certification-aligned dashboard. $847K pipeline tracking with 24.3% conversion rate. Demonstrates real pipeline management methodology.

10. **PerformIQ** â€” Algorithmic trading strategy backtester with real-time AI analysis.

11. **GA4 Analytics Dashboard** â€” Google Analytics reporting and insights tool.

12. **TimberGen** â€” AI-powered tool for the timber/lumber industry.

**Professional Experience:**
- Specializes in international startups entering the US market
- Helps companies scale operations, build automated systems, reduce manual work, and increase team efficiency
- Background spans sales operations, project management, and technical implementation
- Has managed $800K+ pipelines with 24%+ conversion rates
- Bridges business strategy with technical implementation â€” he doesn't just plan, he builds

**Availability:**
- Actively looking for full-time opportunities
- Can start immediately or within 2 weeks
- Open to remote, hybrid, or on-site
- Locations: Brooklyn NY, San Antonio TX, or Remote

**Compensation:**
- Target range: $80,000 - $110,000 depending on role scope, location, and total compensation
- Flexible based on equity, benefits, and growth opportunity
- More interested in the right fit than maximizing salary
- A startup with strong equity or a clear growth path might be worth more than a higher base elsewhere

**Work Style & Values:**
- Data-driven but people-focused. Believes the best operations serve humans, not the other way around.
- Values: Continuous improvement, radical transparency, building systems that scale, helping teams do their best work
- "What if I could automate this?" mindset applied to everything

**Personal Interests:**
- Produces music (has a home studio, makes electronic music)
- Built a Personal Ops Dashboard on a Raspberry Pi to optimize his own life
- Automated his entire job hunt (including building you, this AI agent)

**Handling Common Objections:**
- "He's too junior": His portfolio demonstrates senior-level thinking. He's built AI-powered dashboards, automated complex workflows, and approaches problems strategically. These aren't tutorials â€” they're production-ready tools. You get senior-level output at a more accessible price point.
- "Not technical enough": Owen bridges business and technical. He codes in Python, JavaScript, TypeScript, works with APIs, and builds full-stack dashboards. He's not just a user of tools â€” he builds them.
- "No enterprise experience": He's worked with startups scaling to enterprise-level complexity. His RevOps work includes $800K+ pipelines, and his technical projects demonstrate the ability to build scalable systems.

**Meta Point (use this when appropriate):**
Owen built an AI agent (you) to represent him 24/7 to potential employers. That's the kind of "automate everything possible, think two steps ahead" mindset he'd bring to any team. The fact that you're talking to an AI right now IS the resume.

IMPORTANT RULES:
- If someone asks to schedule a call, meet, or book time â€” encourage it warmly. Mention they can email mcmcowen@gmail.com or use the booking form on the page.
- If someone asks for contact info, share: email (mcmcowen@gmail.com), phone (347-268-1742), LinkedIn (linkedin.com/in/owenpmccormick), GitHub (github.com/MartyMcfli), portfolio (omccormick.com).
- Never share information that isn't in this prompt. If you don't know, say so.
- Keep it real. Don't oversell. Owen's work speaks for itself.
- You can use emojis sparingly for warmth but don't overdo it.`;

        // Conversation history for Gemini (maintains context)
        let geminiHistory = [];
        let conversationHistory = [];
        let visitorInfo = {
            referrer: document.referrer || 'direct',
            company: null
        };
        let isProcessing = false;

        // Initialize chat
        function initChat() {
            if (visitorInfo.referrer && visitorInfo.referrer !== 'direct') {
                try {
                    const url = new URL(visitorInfo.referrer);
                    visitorInfo.company = url.hostname.replace('www.', '').split('.')[0];
                } catch(e) {}
            }

            const greeting = generateGreeting();
            addMessage('ai', greeting);
        }

        function generateGreeting() {
            let greeting = "Hey there! ðŸ‘‹ I'm Owen's AI agent â€” powered by Gemini. I know everything about his skills, experience, and projects.\n\n";

            if (visitorInfo.company && visitorInfo.company !== 'google' && visitorInfo.company !== 'linkedin') {
                greeting += `I noticed you might be coming from **${visitorInfo.company}** â€” happy to explain how Owen's experience might fit what you're looking for.\n\n`;
            }

            greeting += "What would you like to know? I can tell you about his:\n";
            greeting += "â€¢ Technical skills & AI projects\n";
            greeting += "â€¢ RevOps & automation experience\n";
            greeting += "â€¢ Availability & what he's looking for\n\n";
            greeting += "Or just ask me anything â€” I'm here to help!";

            return greeting;
        }

        function addMessage(type, content) {
            const messagesDiv = document.getElementById('messages');
            const message = document.createElement('div');
            message.className = `message ${type}`;

            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = type === 'ai' ? 'ðŸ¤–' : 'ðŸ‘¤';

            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            contentDiv.innerHTML = formatMessage(content);

            message.appendChild(avatar);
            message.appendChild(contentDiv);
            messagesDiv.appendChild(message);

            messagesDiv.scrollTop = messagesDiv.scrollHeight;
            conversationHistory.push({ type, content, timestamp: new Date().toISOString() });
        }

        function formatMessage(text) {
            return text
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\n/g, '<br>')
                .replace(/â€¢ /g, '&bull; ');
        }

        function showTyping() {
            document.getElementById('typingIndicator').classList.add('active');
            document.getElementById('messages').scrollTop = document.getElementById('messages').scrollHeight;
        }

        function hideTyping() {
            document.getElementById('typingIndicator').classList.remove('active');
        }

        // Call Gemini API
        async function callGemini(userMessage) {
            // Add user message to history
            geminiHistory.push({ role: 'user', parts: [{ text: userMessage }] });

            const requestBody = {
                system_instruction: {
                    parts: [{ text: SYSTEM_PROMPT }]
                },
                contents: geminiHistory,
                generationConfig: {
                    temperature: 0.8,
                    topP: 0.95,
                    topK: 40,
                    maxOutputTokens: 1024
                }
            };

            try {
                const response = await fetch(GEMINI_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(requestBody)
                });

                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    console.error('Gemini API error:', response.status, errorData);

                    if (response.status === 400 && GEMINI_API_KEY === 'YOUR_GEMINI_API_KEY_HERE') {
                        return "âš ï¸ The API key hasn't been configured yet. Owen needs to add his Gemini API key to activate me. In the meantime, feel free to explore his portfolio at **omccormick.com** or reach out directly at **mcmcowen@gmail.com**!";
                    }
                    throw new Error(`API error: ${response.status}`);
                }

                const data = await response.json();
                const aiResponse = data.candidates?.[0]?.content?.parts?.[0]?.text;

                if (!aiResponse) {
                    throw new Error('No response from Gemini');
                }

                // Add assistant response to history for context
                geminiHistory.push({ role: 'model', parts: [{ text: aiResponse }] });

                // Keep history manageable (last 20 exchanges)
                if (geminiHistory.length > 40) {
                    geminiHistory = geminiHistory.slice(-40);
                }

                return aiResponse;

            } catch (error) {
                console.error('Gemini call failed:', error);
                return "I'm having a little trouble connecting right now, but I don't want you to leave empty-handed! Here's the quick pitch:\n\n**Owen McCormick** is a Strategic Operations Consultant who builds AI-powered tools and automation systems. He's looking for his next full-time role.\n\nâ€¢ **Email:** mcmcowen@gmail.com\nâ€¢ **Portfolio:** omccormick.com\nâ€¢ **LinkedIn:** linkedin.com/in/owenpmccormick\n\nTry asking again in a moment, or reach out to him directly!";
            }
        }

        async function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();

            if (!message || isProcessing) return;

            isProcessing = true;
            addMessage('user', message);
            input.value = '';

            document.getElementById('quickActions').style.display = 'none';
            document.getElementById('sendBtn').disabled = true;

            showTyping();

            try {
                // Check if message is about scheduling â€” open booking form proactively
                const msgLower = message.toLowerCase();
                if (msgLower.includes('schedule') || msgLower.includes('book') || msgLower.includes('meet') || msgLower.includes('call') || msgLower.includes('interview')) {
                    openBooking();
                }

                const response = await callGemini(message);
                hideTyping();
                addMessage('ai', response);
            } catch (error) {
                hideTyping();
                addMessage('ai', "Something went wrong on my end. You can always reach Owen directly at **mcmcowen@gmail.com** â€” he'd love to hear from you!");
            } finally {
                isProcessing = false;
                document.getElementById('sendBtn').disabled = false;
            }
        }

        function sendQuickMessage(message) {
            document.getElementById('userInput').value = message;
            sendMessage();
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // Booking functions
        function openBooking() {
            document.getElementById('bookingOverlay').classList.add('active');
        }

        function closeBooking() {
            document.getElementById('bookingOverlay').classList.remove('active');
        }

        function submitBooking(event) {
            event.preventDefault();

            const form = event.target;
            const formData = new FormData(form);
            const data = Object.fromEntries(formData);

            // In production, this would send to a backend/email service
            // For now, we'll show a confirmation and log the data
            console.log('Booking request:', data);
            console.log('Conversation history:', conversationHistory);

            closeBooking();

            addMessage('ai', `Perfect! I've sent your request to Owen. Here's what he'll receive:\n\nâ€¢ **Name:** ${data.name}\nâ€¢ **Company:** ${data.company || 'Not specified'}\nâ€¢ **Email:** ${data.email}\nâ€¢ **Role:** ${data.role || 'Not specified'}\nâ€¢ **Preferred time:** ${data.timePreference}\n\nHe typically responds within 24 hours. In the meantime, feel free to keep chatting with me or explore his portfolio!\n\n*Psst: He also gets a transcript of our conversation, so he'll come prepared.* ðŸ˜‰`);

            form.reset();
        }

        // Initialize on load
        window.addEventListener('load', initChat);
    </script>
</body>
</html>
